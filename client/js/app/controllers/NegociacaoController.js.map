{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoController","$","document","querySelector","bind","_inputData","_intputQuatidade","_inputValor","_form","_negociacoesView","NegociacoesView","_listaNegociacoes","Bind","ListaNegociacoes","_mensagemView","MensagemView","_mensagem","Mensagem","_ordemAtual","_negociacoesService","NegociacaoService","_init","lista","then","negociacoes","forEach","negociacao","adiciona","erro","texto","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastra","mensagem","apaga","esvazia","importa","coluna","inverteOrdem","ordena","a","b","Negociacao","DateHelper","textoParaData","value","parseInt","parseFloat","reset","focus"],"mappings":";;;;;;;;IAAMA,oB;;;AAEF,kCAAc;AAAA;;AACV,QAAIC,CAAC,GAAGC,QAAQ,CAACC,aAAT,CAAuBC,IAAvB,CAA4BF,QAA5B,CAAR;AAEA,SAAKG,UAAL,GAAkBJ,CAAC,CAAC,OAAD,CAAnB;AACA,SAAKK,gBAAL,GAAwBL,CAAC,CAAC,aAAD,CAAzB;AACA,SAAKM,WAAL,GAAmBN,CAAC,CAAC,QAAD,CAApB;AACA,SAAKO,KAAL,GAAaP,CAAC,CAAC,OAAD,CAAd;AAEA,SAAKQ,gBAAL,GAAwB,IAAIC,eAAJ,CAAoBT,CAAC,CAAC,kBAAD,CAArB,CAAxB;AACA,SAAKU,iBAAL,GAAyB,IAAIC,IAAJ,CAAS,IAAIC,gBAAJ,EAAT,EAAiC,KAAKJ,gBAAtC,EAAwD,UAAxD,EAAoE,SAApE,EAA+E,QAA/E,EAAyF,cAAzF,CAAzB;AAEA,SAAKK,aAAL,GAAqB,IAAIC,YAAJ,CAAiBd,CAAC,CAAC,eAAD,CAAlB,CAArB;AACA,SAAKe,SAAL,GAAiB,IAAIJ,IAAJ,CAAS,IAAIK,QAAJ,EAAT,EAAyB,KAAKH,aAA9B,EAA6C,OAA7C,CAAjB;AACA,SAAKI,WAAL,GAAmB,EAAnB;AAEA,SAAKC,mBAAL,GAA2B,IAAIC,iBAAJ,EAA3B;;AACA,SAAKC,KAAL;AAEH;;;;4BAEO;AAAA;;AAEJ,WAAKF,mBAAL,CACKG,KADL,GAEKC,IAFL,CAEU,UAAAC,WAAW;AAAA,eACbA,WAAW,CAACC,OAAZ,CAAoB,UAAAC,UAAU;AAAA,iBAC1B,KAAI,CAACf,iBAAL,CAAuBgB,QAAvB,CAAgCD,UAAhC,CAD0B;AAAA,SAA9B,CADa;AAAA,OAFrB,WAMW,UAAAE,IAAI,EAAI;AACX,QAAA,KAAI,CAACZ,SAAL,CAAea,KAAf,GAAuBD,IAAvB;AACH,OARL;;AAUAE,MAAAA,WAAW,CAAC,YAAM;AAEd,QAAA,KAAI,CAACC,kBAAL;AAEH,OAJU,EAIR,IAJQ,CAAX;AAMH;;;6BAEQC,K,EAAO;AAAA;;AAEZA,MAAAA,KAAK,CAACC,cAAN;;AAEA,UAAIP,UAAU,GAAG,KAAKQ,eAAL,EAAjB;;AAEA,WAAKf,mBAAL,CACKgB,QADL,CACcT,UADd,EAEKH,IAFL,CAEU,UAAAa,QAAQ,EAAI;AACd,QAAA,MAAI,CAACzB,iBAAL,CAAuBgB,QAAvB,CAAgCD,UAAhC;;AACA,QAAA,MAAI,CAACV,SAAL,CAAea,KAAf,GAAuBO,QAAvB;AACH,OALL,WAMW,UAAAR,IAAI;AAAA,eAAI,MAAI,CAACZ,SAAL,CAAea,KAAf,GAAuBD,IAA3B;AAAA,OANf;AAOH;;;4BAEO;AAAA;;AAEL,WAAKT,mBAAL,CACMkB,KADN,GAEMd,IAFN,CAEW,UAAAa,QAAQ,EAAI;AACd,QAAA,MAAI,CAACpB,SAAL,CAAea,KAAf,GAAuBO,QAAvB;;AACA,QAAA,MAAI,CAACzB,iBAAL,CAAuB2B,OAAvB;AACH,OALN,WAMY,UAAAV,IAAI;AAAA,eAAI,MAAI,CAACZ,SAAL,CAAea,KAAf,GAAuBD,IAA3B;AAAA,OANhB;AAOF;;;yCAEoB;AAAA;;AAEjB,WAAKT,mBAAL,CACKoB,OADL,CACa,KAAK5B,iBAAL,CAAuBa,WADpC,EAEKD,IAFL,CAEU,UAAAC,WAAW;AAAA,eAAIA,WAAW,CAACC,OAAZ,CAAoB,UAAAC,UAAU,EAAI;AAC/C,UAAA,MAAI,CAACf,iBAAL,CAAuBgB,QAAvB,CAAgCD,UAAhC;;AACA,UAAA,MAAI,CAACV,SAAL,CAAea,KAAf,GAAuB,wBAAvB;AACH,SAHgB,CAAJ;AAAA,OAFrB,WAOW,UAAAD,IAAI;AAAA,eAAI,MAAI,CAACZ,SAAL,CAAea,KAAf,GAAuBD,IAA3B;AAAA,OAPf;AAQH;;;2BAEMY,M,EAAQ;AAEX,UAAI,KAAKtB,WAAL,KAAqBsB,MAAzB,EAAiC;AAC7B,aAAK7B,iBAAL,CAAuB8B,YAAvB;AACH,OAFD,MAEO;AACH,aAAK9B,iBAAL,CAAuB+B,MAAvB,CAA8B,UAACC,CAAD,EAAIC,CAAJ;AAAA,iBAAUD,CAAC,CAACH,MAAD,CAAD,GAAYI,CAAC,CAACJ,MAAD,CAAvB;AAAA,SAA9B;AACH;;AAED,WAAKtB,WAAL,GAAmBsB,MAAnB;AACH;;;sCAEiB;AAEd,aAAO,IAAIK,UAAJ,CACHC,UAAU,CAACC,aAAX,CAAyB,KAAK1C,UAAL,CAAgB2C,KAAzC,CADG,EAEHC,QAAQ,CAAC,KAAK3C,gBAAL,CAAsB0C,KAAvB,CAFL,EAGHE,UAAU,CAAC,KAAK3C,WAAL,CAAiByC,KAAlB,CAHP,CAAP;AAKH;;;mCAEc;AACX,WAAKxC,KAAL,CAAW2C,KAAX;;AACA,WAAK9C,UAAL,CAAgB+C,KAAhB;AACH","sourcesContent":["class NegociacaoController {\n\n    constructor() {\n        let $ = document.querySelector.bind(document);\n\n        this._inputData = $('#data');\n        this._intputQuatidade = $('#quantidade');\n        this._inputValor = $('#valor');\n        this._form = $('.form');\n\n        this._negociacoesView = new NegociacoesView($('#negociacoesView'));\n        this._listaNegociacoes = new Bind(new ListaNegociacoes(), this._negociacoesView, 'adiciona', 'esvazia', 'ordena', 'inverteOrdem');\n\n        this._mensagemView = new MensagemView($('#mensagemView'));\n        this._mensagem = new Bind(new Mensagem(), this._mensagemView, 'texto');\n        this._ordemAtual = '';\n\n        this._negociacoesService = new NegociacaoService();\n        this._init();\n\n    }\n\n    _init() {\n\n        this._negociacoesService\n            .lista()\n            .then(negociacoes =>\n                negociacoes.forEach(negociacao =>\n                    this._listaNegociacoes.adiciona(negociacao))\n            )\n            .catch(erro => {\n                this._mensagem.texto = erro;\n            });\n\n        setInterval(() => {\n\n            this.importaNegociacoes();\n\n        }, 5000);\n\n    }\n\n    adiciona(event) {\n\n        event.preventDefault();\n\n        let negociacao = this._criaNegociacao();\n\n        this._negociacoesService\n            .cadastra(negociacao)\n            .then(mensagem => {\n                this._listaNegociacoes.adiciona(negociacao);\n                this._mensagem.texto = mensagem;\n            })\n            .catch(erro => this._mensagem.texto = erro);\n    }\n\n    apaga() {\n\n       this._negociacoesService\n            .apaga()\n            .then(mensagem => {\n                this._mensagem.texto = mensagem;\n                this._listaNegociacoes.esvazia();\n            })\n            .catch(erro => this._mensagem.texto = erro);\n    }\n\n    importaNegociacoes() {\n\n        this._negociacoesService\n            .importa(this._listaNegociacoes.negociacoes)\n            .then(negociacoes => negociacoes.forEach(negociacao => {\n                    this._listaNegociacoes.adiciona(negociacao)\n                    this._mensagem.texto = 'Negociacoes importadas';\n                })\n            )\n            .catch(erro => this._mensagem.texto = erro);\n    }\n\n    ordena(coluna) {\n\n        if (this._ordemAtual === coluna) {\n            this._listaNegociacoes.inverteOrdem();\n        } else {\n            this._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna]);\n        }\n\n        this._ordemAtual = coluna;\n    }\n\n    _criaNegociacao() {\n\n        return new Negociacao(\n            DateHelper.textoParaData(this._inputData.value),\n            parseInt(this._intputQuatidade.value),\n            parseFloat(this._inputValor.value)\n        );\n    }\n\n    _limpaCampos() {\n        this._form.reset();\n        this._inputData.focus();\n    }\n}"],"file":"NegociacaoController.js"}