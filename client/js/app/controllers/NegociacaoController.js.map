{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacoesView","Bind","ListaNegociacoes","MensagemView","Mensagem","NegociacaoService","Negociacao","DateHelper","NegociacaoController","$","document","querySelector","bind","_inputData","_intputQuatidade","_inputValor","_form","_negociacoesView","_listaNegociacoes","_mensagemView","_mensagem","_ordemAtual","_negociacoesService","_init","lista","then","negociacoes","forEach","negociacao","adiciona","erro","texto","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastra","mensagem","apaga","esvazia","importa","coluna","inverteOrdem","ordena","a","b","textoParaData","value","parseInt","parseFloat","reset","focus","negociacaoController","currentInstance"],"mappings":"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","sourcesContent":["import {NegociacoesView} from '../views/NegociacoesView';\nimport {Bind} from '../helpers/Bind';\nimport {ListaNegociacoes} from '../models/ListaNegociacoes';\nimport {MensagemView} from '../views/MensagemView';\nimport {Mensagem} from '../models/Mensagem';\nimport {NegociacaoService} from '../services/NegociacaoService';\nimport {Negociacao} from '../models/Negociacao';\nimport {DateHelper } from '../helpers/DateHelper';\n\nclass NegociacaoController {\n\n    constructor() {\n        let $ = document.querySelector.bind(document);\n\n        this._inputData = $('#data');\n        this._intputQuatidade = $('#quantidade');\n        this._inputValor = $('#valor');\n        this._form = $('.form');\n\n        this._negociacoesView = new NegociacoesView($('#negociacoesView'));\n        this._listaNegociacoes = new Bind(new ListaNegociacoes(), this._negociacoesView, 'adiciona', 'esvazia', 'ordena', 'inverteOrdem');\n\n        this._mensagemView = new MensagemView($('#mensagemView'));\n        this._mensagem = new Bind(new Mensagem(), this._mensagemView, 'texto');\n        this._ordemAtual = '';\n\n        this._negociacoesService = new NegociacaoService();\n        this._init();\n\n    }\n\n    _init() {\n\n        this._negociacoesService\n            .lista()\n            .then(negociacoes =>\n                negociacoes.forEach(negociacao =>\n                    this._listaNegociacoes.adiciona(negociacao))\n            )\n            .catch(erro => {\n                this._mensagem.texto = erro;\n            });\n\n        setInterval(() => {\n\n            this.importaNegociacoes();\n\n        }, 5000);\n\n    }\n\n    adiciona(event) {\n\n        event.preventDefault();\n\n        let negociacao = this._criaNegociacao();\n\n        this._negociacoesService\n            .cadastra(negociacao)\n            .then(mensagem => {\n                this._listaNegociacoes.adiciona(negociacao);\n                this._mensagem.texto = mensagem;\n            })\n            .catch(erro => this._mensagem.texto = erro);\n    }\n\n    apaga() {\n\n       this._negociacoesService\n            .apaga()\n            .then(mensagem => {\n                this._mensagem.texto = mensagem;\n                this._listaNegociacoes.esvazia();\n            })\n            .catch(erro => this._mensagem.texto = erro);\n    }\n\n    importaNegociacoes() {\n\n        this._negociacoesService\n            .importa(this._listaNegociacoes.negociacoes)\n            .then(negociacoes => negociacoes.forEach(negociacao => {\n                    this._listaNegociacoes.adiciona(negociacao)\n                    this._mensagem.texto = 'Negociacoes importadas';\n                })\n            )\n            .catch(erro => this._mensagem.texto = erro);\n    }\n\n    ordena(coluna) {\n\n        if (this._ordemAtual === coluna) {\n            this._listaNegociacoes.inverteOrdem();\n        } else {\n            this._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna]);\n        }\n\n        this._ordemAtual = coluna;\n    }\n\n    _criaNegociacao() {\n\n        return new Negociacao(\n            DateHelper.textoParaData(this._inputData.value),\n            parseInt(this._intputQuatidade.value),\n            parseFloat(this._inputValor.value)\n        );\n    }\n\n    _limpaCampos() {\n        this._form.reset();\n        this._inputData.focus();\n    }\n}\n\nlet negociacaoController = new NegociacaoController();\n\nexport const currentInstance = () => negociacaoController;"],"file":"NegociacaoController.js"}