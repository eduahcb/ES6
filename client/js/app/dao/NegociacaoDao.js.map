{"version":3,"sources":["../../app-es6/dao/NegociacaoDao.js"],"names":["Negociacao","NegociacaoDao","connection","_connection","_store","negociacao","Promise","resolve","reject","console","log","_connecion","request","transaction","objectStore","add","onsuccess","e","onerror","target","error","cursor","openCursor","negociacoes","atual","result","dado","value","push","_data","_quantidade","_valor","name","clear"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAQA,MAAAA,U,qBAAAA,U;;;+BAEKC,a;AAET,+BAAYC,UAAZ,EAAwB;AAAA;;AACpB,eAAKC,WAAL,GAAmBD,UAAnB;AACA,eAAKE,MAAL,GAAc,aAAd;AACH;;;;mCAEQC,U,EAAY;AAAA;;AAEjB,mBAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AAEpCC,cAAAA,OAAO,CAACC,GAAR,CAAY,KAAI,CAACC,UAAjB;;AAEA,kBAAIC,OAAO,GAAG,KAAI,CAACT,WAAL,CAAiBU,WAAjB,CAA6B,CAAC,KAAI,CAACT,MAAN,CAA7B,EAA4C,WAA5C,EACTU,WADS,CACG,KAAI,CAACV,MADR,EAETW,GAFS,CAELV,UAFK,CAAd;;AAIAO,cAAAA,OAAO,CAACI,SAAR,GAAoB,UAAAC,CAAC,EAAI;AACrBV,gBAAAA,OAAO;AACV,eAFD;;AAIAK,cAAAA,OAAO,CAACM,OAAR,GAAkB,UAAAD,CAAC,EAAI;AACnBR,gBAAAA,OAAO,CAACC,GAAR,CAAYO,CAAC,CAACE,MAAF,CAASC,KAArB;AACAZ,gBAAAA,MAAM,CAAC,yCAAD,CAAN;AACH,eAHD;AAIH,aAhBM,CAAP;AAiBH;;;uCAEY;AAAA;;AAET,mBAAO,IAAIF,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AAEpC,kBAAIa,MAAM,GAAG,MAAI,CAAClB,WAAL,CACRU,WADQ,CACI,MAAI,CAACT,MADT,EACiB,WADjB,EAERU,WAFQ,CAEI,MAAI,CAACV,MAFT,EAGRkB,UAHQ,EAAb;;AAKA,kBAAIC,WAAW,GAAG,EAAlB;;AAEAF,cAAAA,MAAM,CAACL,SAAP,GAAmB,UAAAC,CAAC,EAAI;AAEpB,oBAAIO,KAAK,GAAGP,CAAC,CAACE,MAAF,CAASM,MAArB;;AAEA,oBAAID,KAAJ,EAAW;AAEP,sBAAIE,IAAI,GAAGF,KAAK,CAACG,KAAjB;AAEAJ,kBAAAA,WAAW,CAACK,IAAZ,CAAiB,IAAI5B,UAAJ,CAAe0B,IAAI,CAACG,KAApB,EAA2BH,IAAI,CAACI,WAAhC,EAA6CJ,IAAI,CAACK,MAAlD,CAAjB;AAEAP,kBAAAA,KAAK,YAAL;AAEH,iBARD,MAQO;AACHjB,kBAAAA,OAAO,CAACgB,WAAD,CAAP;AACH;AACJ,eAfD;;AAiBAF,cAAAA,MAAM,CAACH,OAAP,GAAiB,UAAAD,CAAC,EAAI;AAClBR,gBAAAA,OAAO,CAACC,GAAR,CAAYO,CAAC,CAACE,MAAF,CAASC,KAAT,CAAeY,IAA3B;AACAxB,gBAAAA,MAAM,CAAC,wCAAD,CAAN;AACH,eAHD;AAKH,aA/BM,CAAP;AAgCH;;;uCAEY;AAAA;;AAET,mBAAO,IAAIF,OAAJ,CAAa,UAACC,OAAD,EAAUC,MAAV,EAAqB;AAErC,kBAAII,OAAO,GAAG,MAAI,CAACT,WAAL,CACTU,WADS,CACG,MAAI,CAACT,MADR,EACgB,WADhB,EAETU,WAFS,CAEG,MAAI,CAACV,MAFR,EAGT6B,KAHS,EAAd;;AAKArB,cAAAA,OAAO,CAACI,SAAR,GAAoB,UAAAC,CAAC;AAAA,uBAAIV,OAAO,CAAC,qCAAD,CAAX;AAAA,eAArB;;AAEAK,cAAAA,OAAO,CAACM,OAAR,GAAkB,UAAAD,CAAC;AAAA,uBAAIT,MAAM,CAAC,yCAAD,CAAV;AAAA,eAAnB;AAEH,aAXM,CAAP;AAYH","sourcesContent":["import {Negociacao} from '../models/Negociacao';\n\nexport class NegociacaoDao {\n\n    constructor(connection) {\n        this._connection = connection;\n        this._store = 'Negociacoes';\n    }\n\n    adiciona(negociacao) {\n\n        return new Promise((resolve, reject) => {\n\n            console.log(this._connecion);\n\n            let request = this._connection.transaction([this._store], 'readwrite')\n                .objectStore(this._store)\n                .add(negociacao);\n\n            request.onsuccess = e => {\n                resolve();\n            }\n\n            request.onerror = e => {\n                console.log(e.target.error);\n                reject('Não foi possível adicionar a negociação');\n            }\n        });\n    }\n\n    listaTodos() {\n\n        return new Promise((resolve, reject) => {\n\n            let cursor = this._connection\n                .transaction(this._store, 'readwrite')\n                .objectStore(this._store)\n                .openCursor();\n\n            let negociacoes = [];\n\n            cursor.onsuccess = e => {\n\n                let atual = e.target.result;\n\n                if (atual) {\n\n                    let dado = atual.value;\n\n                    negociacoes.push(new Negociacao(dado._data, dado._quantidade, dado._valor));\n\n                    atual.continue();\n\n                } else {\n                    resolve(negociacoes);\n                }\n            }\n\n            cursor.onerror = e => {\n                console.log(e.target.error.name);\n                reject('Não foi possível listar as negociações');\n            }\n\n        });\n    }\n\n    apagaTodos() {\n\n        return new Promise( (resolve, reject) => {\n\n            let request = this._connection\n                .transaction(this._store, 'readwrite')\n                .objectStore(this._store)\n                .clear();\n\n            request.onsuccess = e => resolve('Negociações removidadas com sucesso');\n\n            request.onerror = e => reject('Não foi possível remover as negociações');\n\n        });\n    }\n}"],"file":"NegociacaoDao.js"}